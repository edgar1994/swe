<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
>
<h:head>
    <title>#{msg['NEUERUSER.TITEL']}</title>
    <link rel="stylesheet" href="resources/index.css" type="text/css"/>
</h:head>
<body>
<h:form>
    <div align="right">
        <p:commandButton value="#{msg['SPRACHE.DEUTSCH']}" action='#{languageHandler.actionLanguage("de")}'
                         immediate="true"/>
        <p:commandButton value="#{msg['SPRACHE.ENGLISCH']}" action='#{languageHandler.actionLanguage("en")}'
                         immediate="true"/>
        <p:commandButton value="#{msg['LOGIN.AUSLOGGEN']}" action='#{loginController.logout}' immediate="true"/>
    </div>
    <div>
        <h:form>
            <p:commandButton value="Mainpage" id="mainpage" action="${indexController.switchToIndex}" immediate="true"/>
            <p:commandButton value="#{msg['USER.BEZEICHNUNG']}" id="mitarbeiter"
                             action="${userController.switchToUser()}"
                             immediate="true"/>
            <p:commandButton value="#{msg['GRUPPENTABELLE.TITEL']}" id="Gruppe"
                             action="${gruppeController.switchToGruppe()}"
                             immediate="true"/>
            <p:commandButton value="#{msg['PROJEKTTABELLE.TITEL']}" id="Projekt"
                             action="${projektController.switchToProjekt()}"
                             immediate="true"/>
        </h:form>
    </div>
    <div id="content">
        <ui:insert name="content">
            <h:form>
                <p:growl id="growl" showDetail="true" sticky="true"/>
                <p:panelGrid var="user" value="#{userController.selectedEntity}" columns="2"
                             headerClass="header"
                             footerClass="footer">
                    <h:outputLabel value="#{msg['NEUERUSER.ROLLE']}" for="rolle"/>
                    <h:panelGroup>
                        <h:selectOneMenu id="rolle" value="#{userController.selectedEntity.rolle}">
                            <f:selectItems var="form" value="#{enumController.getRolleValues()}" itemValue="#{form}"
                                           itemLabel="#{msg[form.rolle]}"/>
                        </h:selectOneMenu>
                    </h:panelGroup>
                    <p:outputLabel value="#{msg['NEUERUSER.USERNAME']}"/>
                    <p:inputText value="#{userController.selectedEntity.username}" required="true"
                                 requiredMessage="#{msg['NEUERUSER.USERNAME.MESSAGE']}">
                        <f:validator validatorId="usernameValidator"/>
                    </p:inputText>
                    <p:outputLabel value="#{msg['NEUERUSER.VORNAME']}:"/>
                    <p:inputText value="#{userController.selectedEntity.vorname}"/>
                    <p:outputLabel value="#{msg['NEUERUSER.NACHNAME']}:"/>
                    <p:inputText value="#{userController.selectedEntity.nachname}"/>
                    <p:outputLabel value="#{msg['NEUERUSER.ADRESSE.STRASSE']}:"/>
                    <p:inputText value="#{userController.selectedEntity.adresse.strasse}"/>
                    <p:outputLabel value="#{msg['NEUERUSER.ADRESSE.PLZ']}:"/>
                    <p:inputText value="#{userController.selectedEntity.adresse.plz}"/>
                    <p:outputLabel value="#{msg['NEUERUSER.ADRESSE.STADT']}:"/>
                    <p:inputText value="#{userController.selectedEntity.adresse.stadt}"/>

                </p:panelGrid>
                <p:commandButton
                        action="#{userController.save()}"
                        value="#{msg['BUTTON.SPEICHERN']}"
                        actionListener="#{growlView.showAction(msg['NEUERUSER.MESSAGE.SUMMARY'], msg['NEUERUSER.MESSAGE.TEXT'])}"
                        update=":growl"/>
                <p:commandButton action="#{userController.cancel}" value="#{msg['BUTTON.ABBRECHEN']}"
                                 immediate="true"/>
            </h:form>
        </ui:insert>
    </div>
</h:form>
</body>
<f:event listener="#{loginController.checkLoggedIn}" type="preRenderView"/>
<f:event type="preRenderView" listener="#{loginController.checkLoggedIn}"/>
<f:event type="preRenderView" listener="#{loginController.updateCurrentUser}"/>
<f:event type="preRenderView" listener="#{loginController.checkFirstLogin}"/>
</html>
