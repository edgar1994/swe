<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
>
<h:head>
    <title>#{msg['NEUERUSER.TITEL']}</title>
    <link rel="stylesheet" href="resources/index.css" type="text/css"/>
</h:head>
<body>
<h:form>
    <div align="right">
        <p:commandButton value="#{msg['SPRACHE.DEUTSCH']}" action='#{languageHandler.actionLanguage("de")}'
                         immediate="true"/>
        <p:commandButton value="#{msg['SPRACHE.ENGLISCH']}" action='#{languageHandler.actionLanguage("en")}'
                         immediate="true"/>
        <p:commandButton value="#{msg['LOGIN.AUSLOGGEN']}" action='#{loginController.logout}' immediate="true"/>
    </div>
</h:form>
<div>
    <h:form>
        <p:commandButton value="Mainpage" id="mainpage" action="${indexController.switchToIndex}" immediate="true"/>
        <p:commandButton value="#{msg['USER.BEZEICHNUNG']}" id="mitarbeiter"
                         action="${userController.switchToUser()}"
                         immediate="true"/>
        <p:commandButton value="#{msg['GRUPPENTABELLE.TITEL']}" id="Gruppe"
                         action="${gruppeController.switchToGruppe()}"
                         immediate="true"/>
        <p:commandButton value="#{msg['PROJEKTTABELLE.TITEL']}" id="Projekt"
                         action="${projektController.switchToProjekt()}"
                         immediate="true"/>
    </h:form>
</div>


<div id="content">
    <h:form>
        <ui:insert name="content">

            <p:growl id="growl" showDetail="true" sticky="true"/>
            <p:panelGrid var="user" value="#{userController.selectedEntity}" columns="2"
                         headerClass="header"
                         footerClass="footer">
                <h:outputLabel value="#{msg['NEUERUSER.ROLLE']}" for="rolle"/>
                <h:panelGroup>
                    <h:selectOneMenu id="rolle" value="#{userController.selectedEntity.rolle}">
                        <f:selectItems var="form" value="#{enumController.getRolleValues()}" itemValue="#{form}"
                                       itemLabel="#{msg[form.rolle]}"/>
                        <p:ajax event="change"/>
                    </h:selectOneMenu>
                </h:panelGroup>
                <p:outputLabel value="#{msg['NEUERUSER.USERNAME']}"/>
                <p:inputText value="#{userController.selectedEntity.username}" required="true"
                             requiredMessage="#{msg['NEUERUSER.USERNAME.MESSAGE']}">
                    <p:ajax event="change"/>
                    <f:validator validatorId="usernameValidator"/>
                </p:inputText>

                <p:outputLabel for="vorname" value="#{msg['NEUERUSER.VORNAME']}:"/>
                <p:inputText id="vorname" value="#{userController.selectedEntity.vorname}">
                    <p:ajax event="change"/>
                </p:inputText>

                <p:outputLabel for="nachname" value="#{msg['NEUERUSER.NACHNAME']}:"/>
                <p:inputText id="nachname" value="#{userController.selectedEntity.nachname}">
                    <p:ajax event="change"/>
                </p:inputText>

                <p:outputLabel value="#{msg['NEUERUSER.ADRESSE.STRASSE']}:"/>
                <p:inputText value="#{userController.selectedEntity.adresse.strasse}">
                    <p:ajax event="change"/>
                </p:inputText>

                <p:outputLabel value="#{msg['NEUERUSER.ADRESSE.PLZ']}:"/>
                <p:inputText value="#{userController.selectedEntity.adresse.plz}">
                    <p:ajax event="change"/>
                </p:inputText>

                <p:outputLabel value="#{msg['NEUERUSER.ADRESSE.STADT']}:"/>
                <p:inputText value="#{userController.selectedEntity.adresse.stadt}">
                    <p:ajax event="change"/>
                </p:inputText>

            </p:panelGrid>
            <p:commandButton value="#{msg['BUTTON.SPEICHERN']}" action="${userController.save()}" immediate="true"/>
            <p:commandButton action="#{userController.switchToUser}" value="#{msg['BUTTON.ABBRECHEN']}"
                             immediate="true"/>

        </ui:insert>
    </h:form>
</div>


</body>
<f:event listener="#{loginController.checkLoggedIn}" type="preRenderView"/>
<f:event type="preRenderView" listener="#{loginController.checkLoggedIn}"/>
<f:event type="preRenderView" listener="#{loginController.updateCurrentUser}"/>
<f:event type="preRenderView" listener="#{loginController.checkFirstLogin}"/>
</html>
